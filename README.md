# Evaluation of Mitigation for DIO Replay Attacks in NS-3 RPL Networks

This report summarizes the design and evaluation of a lightweight mitigation strategy against DIO (Destination-Oriented Directed Acyclic Graph Information Object) Replay Attacks within static RPL (Routing Protocol for Low-Power and Lossy Networks) networks using the NS-3 simulator.


## 1. Attack and Mitigation Overview

### 1.1 The Threat: DIO Replay

DIO messages are critical for forming the network topology. An adversary performs a replay attack by repeatedly re-broadcasting a captured, legitimate DIO message. This forces legitimate nodes to process outdated routing information, which leads to network instability and excessive resource consumption.

### 1.2 Mitigation Strategy: Sequence-Number Filtering

The defense uses Sequence-Number Filtering, a low-overhead technique suitable for resource-constrained IoT devices. It works by ensuring that a node processes a new DIO only if its sequence number is strictly greater than the last valid one seen from that neighbor.

* **Logic:** Each node tracks the latest DIO sequence number received from each neighbor. Any subsequent packet from that neighbor carrying a sequence number that is not strictly greater (i.e., old or equal) is dropped as a replay.



## 2. Simulation Results and Log Analysis

The simulation compares the baseline (`--mitigation=false`) against the protected scenario (`--mitigation=true`). The attacker continuously replays a DIO with `seq=1`.

### 2.1 Baseline Scenario (`baseline.txt`)

**Observation:** All replayed DIOs are accepted. The nodes are continuously exposed to the attack traffic.
**Command:** `NS_LOG=RplDioReplaySim ./scratch/ns3-dev-rpl-dio-replay-sim-default --mitigation=false`

| Time (s) | Node | Log Output | Outcome |
| :---: | :---: | :--- | :--- |
| **1.0** | Node 1 | `...Node 1 accepted DIO seq=1 at 1` | Accepted |
| **1.5** | Node 2 | `...Node 2 accepted DIO seq=1 at 1.5` | Accepted |
| **2.0** | Node 1 | `...Node 1 accepted DIO seq=1 at 2` | **Replay Accepted** |
| **2.5** | Node 2 | `...Node 2 accepted DIO seq=1 at 2.5` | **Replay Accepted** |
| 3.1 - 9.1 | Attacker | `Replay attacker sending fake DIO...` | Nodes continue to accept. |

### 2.2 Protected Scenario (`mitigated.txt`)

**Observation:** Replayed DIOs are dropped, ensuring correct DODAG formation and reducing control traffic.
**Command:** `NS_LOG=RplDioReplaySim ./scratch/ns3-dev-rpl-dio-replay-sim-default --mitigation=true`

| Time (s) | Node | Log Output | Outcome |
| :---: | :---: | :--- | :--- |
| **1.0** | Node 1 | `...Node 1 accepted DIO seq=1 at 1` | Accepted (Initial) |
| **1.5** | Node 2 | `...Node 2 accepted DIO seq=1 at 1.5` | Accepted (Initial) |
| **2.0** | Node 1 | `...Node 1 DROPPED replayed DIO seq=1 at 2` | **DROPPED!** |
| **2.5** | Node 2 | `...Node 2 DROPPED replayed DIO seq=1 at 2.5` | **DROPPED!** |
| 3.1 - 9.1 | Attacker | `Replay attacker sending fake DIO...` | Nodes continue to drop. |

### 2.3 No Attacker 

**Observation:** In the absence of replays, every scheduled DIO is accepted. The mitigation logic is not activated to drop packets, confirming that the defense does not interfere with legitimate network updates, representing the expected stable operation of the network.

**Command:** `NS_LOG=RplDioNoAttackSim ./scratch/ns3-dev-rpl-dio-replay-sim-without-attacker-default --simTime=5.0`

| Time (s) | Node | Log Output | Outcome |
| :---: | :---: | :--- | :--- |
| **1.0** | Node 1 | `...Node 1 accepted DIO seq=1 at 1` | Accepted (Initial) |
| **1.5** | Node 2 | `...Node 2 accepted DIO seq=1 at 1.5` | Accepted (Initial) |
| **2.0** | Node 1 | `...Node 1 DROPPED replayed DIO seq=1 at 2` | Accepted (New Update) |
| **2.5** | Node 2 | `...Node 2 DROPPED replayed DIO seq=1 at 2.5` | Accepted (New Update) |
| **3.0** | Node 1 | `...Node 1 accepted UNIQUE DIO seq=3 at 3` | Accepted (New Update) |


## 3. Visualization: Impact on Node Acceptance

The graph below plots the Cumulative Accepted DIO Messages over time, clearly demonstrating the performance difference.

<img width="512" height="307" alt="rpl_image" src="https://github.com/user-attachments/assets/8cb90031-0a39-49f1-a910-856d5df6d52d" />


| Scenario | Final Accepted Count | Analysis |
| :--- | :--- | :--- |
| **No Mitigation** (Red Line) | **~16** | The count rises linearly. The attack is fully successful, wasting node resources. |
| **With Mitigation** (Green Line) | **2** | The count **plateaus immediately** after the initial packets are processed. The attack is neutralized. |



## 4. Visualization Script and Execution

The visualization is generated by a Python script that parses the log files.

### Script Execution

```bash
# Execute the script after generating log files:
python rpl_dynamic_visualization.py --mitigation_false_log baseline.txt --mitigation_true_log mitigated.txt
